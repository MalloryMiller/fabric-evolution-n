! Q^(0) components
a11 = (B(1,1)*eta1 + (2.0d0)*M(1,1)*(eta2 + (2.0d0)*eta3) + lam + (2.0d0)*mu)*xi**(2.0d0)
a22 = (B(1,2)*eta1 + (M(1,1) + M(2,2))*eta3 + mu)*xi**(2.0d0)
a33 = (B(1,3)*eta1 + (M(1,1) + M(3,3))*eta3 + mu)*xi**(2.0d0)
a23 = ((B(1,4)*eta1)/Sqrt((2.0d0)) + M(2,3)*eta3)*xi**(2.0d0)
a13 = ((B(1,5)*eta1)/Sqrt((2.0d0)) + M(1,3)*(eta2 + (2.0d0)*eta3))*xi**(2.0d0)
a12 = ((B(1,6)*eta1)/Sqrt((2.0d0)) + M(1,2)*(eta2 + (2.0d0)*eta3))*xi**(2.0d0)

! Q^(1) components
b11 = (Sqrt((2.0d0))*B(1,5)*eta1 + (2.0d0)*M(1,3)*(eta2 + (2.0d0)*eta3))*xi
b22 = (Sqrt((2.0d0))*B(2,5)*eta1 + (2.0d0)*M(1,3)*eta3)*xi
b33 = (Sqrt((2.0d0))*B(3,5)*eta1 + (2.0d0)*M(1,3)*(eta2 + (2.0d0)*eta3))*xi
b23 = (B(4,5)*eta1 + M(1,2)*(eta2 + eta3))*xi
b13 = (B(5,5)*eta1 + (M(1,1) + M(3,3))*(eta2 + eta3) + lam + mu)*xi
b12 = (B(5,6)*eta1 + M(2,3)*(eta2 + eta3))*xi

! Q^(2) components
c11 = B(1,3)*eta1 + (M(1,1) + M(3,3))*eta3 + mu
c22 = B(2,3)*eta1 + (M(2,2) + M(3,3))*eta3 + mu
c33 = B(3,3)*eta1 + (2.0d0)*M(3,3)*(eta2 + (2.0d0)*eta3) + lam + (2.0d0)*mu
c23 = (B(3,4)*eta1)/Sqrt((2.0d0)) + M(2,3)*(eta2 + (2.0d0)*eta3)
c13 = (B(3,5)*eta1)/Sqrt((2.0d0)) + M(1,3)*(eta2 + (2.0d0)*eta3)
c12 = (B(3,6)*eta1)/Sqrt((2.0d0)) + M(1,2)*eta3

! det(Q-W)=0 polynomial coefs
ri(0) = -(a13**2*a22) + 2*a12*a13*a23 - a11*a23**2 - a12**2*a33 + a11*a22*a33 + (a12**2 + a13**2 - a11*a22 + a23**2 - (a11 + a22)*a33)*w + (a11 + a22 + a33)*w**2 - w**3
ri(1) = -(a23**2*b11) - 2*a12*a33*b12 - a13**2*b22 + a11*a33*b22 + 2*a12*a13*b23 + 2*a23*(a13*b12 + a12*b13 - a11*b23) - a12**2*b33 + a22*(a33*b11 - 2*a13*b13 + a11*b33) + (2*a12*b12 + 2*a13*b13 - a33*(b11 + b22) + 2*a23*b23 - a22*(b11 + b33) - a11*(b22 + b33))*w + (b11 + b22 + b33)*w**2
ri(2) = -(a22*b13**2) - 2*a13*b13*b22 + 2*a13*b12*b23 + 2*a12*b13*b23 - a11*b23**2 + a22*b11*b33 - 2*a12*b12*b33 + a11*b22*b33 - a23**2*c11 - 2*a13*a22*c13 - a13**2*c22 + a33*(-b12**2 + b11*b22 + a22*c11 - 2*a12*c12 + a11*c22) + 2*a12*a13*c23 + 2*a23*(b12*b13 - b11*b23 + a13*c12 + a12*c13 - a11*c23) - a12**2*c33 + a11*a22*c33 + (b12**2 + b13**2 + b23**2 - b22*b33 - b11*(b22 + b33) + 2*a12*c12 + 2*a13*c13 - a33*(c11 + c22) + 2*a23*c23 - a22*(c11 + c33) - a11*(c22 + c33))*w + (c11 + c22 + c33)*w**2
ri(3) = -(b13**2*b22) - b12**2*b33 + a33*b22*c11 - 2*a23*b23*c11 + a22*b33*c11 - 2*a33*b12*c12 + 2*a13*b23*c12 - 2*a12*b33*c12 + 2*a23*b12*c13 - 2*a13*b22*c13 + 2*a12*b23*c13 + a11*b33*c22 + 2*a13*b12*c23 - 2*a11*b23*c23 + 2*b13*(b12*b23 + a23*c12 - a22*c13 - a13*c22 + a12*c23) - 2*a12*b12*c33 + a11*b22*c33 + b11*(-b23**2 + b22*b33 + a33*c22 - 2*a23*c23 + a22*c33) + (2*b12*c12 + 2*b13*c13 - b33*(c11 + c22) + 2*b23*c23 - b22*(c11 + c33) - b11*(c22 + c33))*w
ri(4) = -(b23**2*c11) - 2*b12*b33*c12 - a33*c12**2 + 2*a23*c12*c13 - a22*c13**2 - b13**2*c22 + b11*b33*c22 + a33*c11*c22 - 2*a13*c13*c22 + 2*b12*b13*c23 - 2*a23*c11*c23 + 2*a13*c12*c23 + 2*a12*c13*c23 - a11*c23**2 + 2*b23*(b13*c12 + b12*c13 - b11*c23) - b12**2*c33 + a22*c11*c33 - 2*a12*c12*c33 + a11*c22*c33 + b22*(b33*c11 - 2*b13*c13 + b11*c33) + (c12**2 + c13**2 - c11*c22 + c23**2 - (c11 + c22)*c33)*w
ri(5) = -(b33*c12**2) + 2*b23*c12*c13 - b22*c13**2 + b33*c11*c22 - 2*b13*c13*c22 - 2*b23*c11*c23 + 2*b13*c12*c23 + 2*b12*c13*c23 - b11*c23**2 + b22*c11*c33 - 2*b12*c12*c33 + b11*c22*c33
ri(6) = -(c13**2*c22) + 2*c12*c13*c23 - c11*c23**2 - c12**2*c33 + c11*c22*c33
